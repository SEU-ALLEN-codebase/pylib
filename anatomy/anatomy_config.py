#!/usr/bin/env python

#================================================================
#   Copyright (C) 2022 Yufeng Liu (Braintell, Southeast University). All rights reserved.
#   
#   Filename     : __init__.py
#   Author       : Yufeng Liu
#   Date         : 2022-11-10
#   Description  : 
#
#================================================================

import os

__CUR_ABS_PATH = os.path.abspath(os.path.dirname(os.path.realpath(__file__)))

ANATOMY_TREE_FILE = os.path.join(__CUR_ABS_PATH, 'resources/tree.json')
ID_MAP_RES25_FILE = os.path.join(__CUR_ABS_PATH, 'resources/annotation25_16bit_id_mapping.json')
MASK_CCF25_FILE = os.path.join(__CUR_ABS_PATH, 'resources/annotation_25.nrrd')
MASK_CCF25_R314_FILE = os.path.join(__CUR_ABS_PATH, 'resources/annotation_25_R314.nrrd')

REGIONS316_FILE = os.path.join(__CUR_ABS_PATH, 'resources/CCFv3_Summary_Structures.xlsx')

# Regional indices for brain ventriles
VENTRILES = (81, 98, 108, 129, 140, 145, 153, 164)
# Regional indices for high-granuarity brain structures in the mask. These regions
# contain both sub-regions and itself (exclusive of listed sub-regions) in the 
# MASK314 and MASK671
NON_R314_SALIENT = (313, 354, 477, 512, 549, 698, 703, 771, 803, 997, 1089, 
                    1097, 549009203, 560581551)
# Regional indices for the sub-regions of fiber tracts
FIBER_TRACTS = (6, 54, 62, 78, 93, 102, 117, 125, 158, 190, 198, 229, 237, 
                301, 326, 336, 349, 380, 397, 413, 428, 436, 443, 449, 466, 
                482, 506, 530, 538, 553, 579, 595, 603, 611, 633, 658, 665, 
                673, 681, 690, 697, 728, 744, 753, 784, 484682512, 484682516, 
                484682520, 794, 484682524, 798, 484682528, 802, 812, 832, 
                841, 848, 850, 863, 866, 884, 900, 908, 911, 916, 924, 940, 
                949, 956, 964, 971, 986, 1009, 1016, 1043, 1051, 1060, 1092, 
                1108, 1116, 1123)

# Regional indices for the original 671 salient brain regions in the CCFv3 atlas/mask
REGION671 = [        1,         2,         6,         7,         9,
              10,        12,        15,        17,        19,        20,
              23,        26,        27,        28,        30,        33,
              35,        36,        38,        41,        42,        50,
              52,        54,        56,        58,        59,        62,
              63,        64,        66,        67,        68,        72,
              74,        75,        78,        81,        83,        84,
              88,        91,        93,        96,        97,        98,
             100,       101,       102,       105,       106,       108,
             113,       114,       115,       117,       118,       120,
             121,       122,       123,       125,       126,       128,
             129,       131,       132,       133,       136,       139,
             140,       143,       145,       146,       147,       148,
             149,       153,       155,       156,       158,       159,
             162,       163,       164,       169,       171,       173,
             177,       178,       180,       181,       186,       187,
             188,       189,       190,       194,       196,       197,
             198,       201,       202,       203,       204,       206,
             207,       209,       210,       211,       214,       215,
             217,       218,       222,       223,       225,       226,
             229,       230,       231,       233,       234,       237,
             238,       243,       246,       249,       250,       251,
             252,       255,       257,       258,       260,       262,
             263,       266,       268,       269,       271,       272,
             274,       279,       280,       281,       286,       287,
             288,       289,       292,       296,       298,       301,
             303,       304,       305,       307,       310,       311,
             313,       314,       318,       320,       321,       325,
             326,       327,       328,       330,       332,       333,
             334,       335,       336,       338,       342,       344,
             347,       349,       350,       351,       354,       355,
             356,       358,       362,       363,       364,       366,
             368,       372,       374,       377,       380,       381,
             382,       390,       393,       397,       401,       403,
             412,       413,       414,       421,       422,       423,
             427,       428,       429,       430,       433,       434,
             436,       437,       440,       441,       442,       443,
             445,       448,       449,       450,       451,       452,
             456,       460,       461,       463,       466,       469,
             470,       477,       478,       482,       483,       484,
             488,       501,       502,       506,       507,       510,
             512,       515,       520,       523,       525,       526,
             527,       530,       531,       534,       538,       540,
             542,       543,       544,       549,       551,       553,
             556,       558,       559,       564,       565,       566,
             573,       574,       575,       576,       577,       579,
             580,       581,       582,       583,       587,       588,
             590,       591,       593,       595,       596,       597,
             598,       599,       600,       601,       603,       604,
             605,       608,       609,       610,       611,       612,
             613,       614,       616,       620,       621,       622,
             625,       628,       629,       630,       632,       633,
             634,       638,       639,       642,       643,       648,
             649,       651,       653,       654,       655,       656,
             657,       658,       661,       662,       663,       664,
             665,       667,       670,       671,       672,       673,
             675,       678,       679,       680,       681,       685,
             687,       689,       690,       692,       693,       694,
             696,       697,       698,       699,       702,       703,
             704,       706,       707,       711,       718,       721,
             725,       727,       728,       729,       732,       733,
             735,       741,       743,       744,       749,       750,
             753,       754,       755,       757,       759,       763,
             765,       767,       771,       772,       773,       774,
             778,       780,       781,       783,       784,       786,
             788,       791,       794,       795,       797,       798,
             800,       802,       803,       804,       805,       806,
             810,       811,       812,       814,       816,       819,
             820,       821,       827,       828,       830,       831,
             832,       834,       836,       838,       839,       841,
             842,       843,       844,       846,       847,       848,
             849,       850,       851,       852,       854,       857,
             859,       862,       863,       866,       867,       869,
             872,       873,       874,       878,       880,       882,
             884,       888,       889,       893,       897,       898,
             900,       902,       903,       905,       906,       907,
             908,       910,       911,       912,       914,       916,
             919,       924,       927,       929,       930,       931,
             935,       936,       939,       940,       943,       944,
             945,       946,       949,       950,       951,       952,
             954,       955,       956,       957,       959,       961,
             962,       963,       964,       965,       966,       968,
             969,       970,       971,       973,       974,       975,
             976,       977,       978,       980,       981,       982,
             984,       986,       988,       989,       990,       996,
             997,       998,      1004,      1005,      1006,      1007,
            1009,      1010,      1015,      1016,      1020,      1021,
            1022,      1023,      1025,      1026,      1029,      1030,
            1031,      1033,      1035,      1037,      1038,      1039,
            1041,      1043,      1044,      1045,      1046,      1047,
            1048,      1049,      1051,      1052,      1054,      1056,
            1058,      1060,      1061,      1062,      1064,      1066,
            1069,      1070,      1072,      1074,      1077,      1079,
            1081,      1084,      1085,      1086,      1088,      1089,
            1090,      1091,      1092,      1093,      1094,      1096,
            1097,      1098,      1101,      1102,      1104,      1105,
            1106,      1107,      1108,      1109,      1111,      1113,
            1114,      1116,      1120,      1121,      1123,      1125,
            1126,      1127,      1128,      1139,     10671,     10703,
           10704, 182305693, 182305697, 182305701, 182305705, 182305709,
       182305713, 312782550, 312782554, 312782558, 312782562, 312782566,
       312782570, 312782578, 312782582, 312782586, 312782590, 312782594,
       312782598, 312782604, 312782608, 312782612, 312782616, 312782620,
       312782624, 312782632, 312782636, 312782640, 312782644, 312782648,
       312782652, 484682470, 484682508, 484682512, 484682516, 484682520,
       484682524, 484682528, 496345664, 496345668, 496345672, 526157192,
       526157196, 526322264, 527696977, 549009203, 549009211, 549009215,
       549009219, 549009223, 549009227, 560581551, 560581559, 560581563,
       563807435, 563807439, 576073699, 576073704, 589508447, 589508451,
       589508455, 599626923, 599626927, 606826647, 606826651, 606826655,
       606826659, 606826663, 607344830, 607344834, 607344838, 607344842,
       607344846, 607344850, 607344854, 607344858, 607344862, 614454277]

# Indices for salients regions that are neither ventriles and fiber tracts in REGION671
SALIENT_REGIONS = [        1,         2,         7,         9,        10,        12,
              15,        17,        19,        20,        23,        26,
              27,        28,        30,        33,        35,        36,
              38,        41,        42,        50,        52,        56,
              58,        59,        63,        64,        66,        67,
              68,        72,        74,        75,        83,        84,
              88,        91,        96,        97,       100,       101,
             105,       106,       113,       114,       115,       118,
             120,       121,       122,       123,       126,       128,
             131,       132,       133,       136,       139,       143,
             146,       147,       148,       149,       155,       156,
             159,       162,       163,       169,       171,       173,
             177,       178,       180,       181,       186,       187,
             188,       189,       194,       196,       197,       201,
             202,       203,       204,       206,       207,       209,
             210,       211,       214,       215,       217,       218,
             222,       223,       225,       226,       230,       231,
             233,       234,       238,       243,       246,       249,
             250,       251,       252,       255,       257,       258,
             260,       262,       263,       266,       268,       269,
             271,       272,       274,       279,       280,       281,
             286,       287,       288,       289,       292,       296,
             298,       303,       304,       305,       307,       310,
             311,       313,       314,       318,       320,       321,
             325,       327,       328,       330,       332,       333,
             334,       335,       338,       342,       344,       347,
             350,       351,       354,       355,       356,       358,
             362,       363,       364,       366,       368,       372,
             374,       377,       381,       382,       390,       393,
             401,       403,       412,       414,       421,       422,
             423,       427,       429,       430,       433,       434,
             437,       440,       441,       442,       445,       448,
             450,       451,       452,       456,       460,       461,
             463,       469,       470,       477,       478,       483,
             484,       488,       501,       502,       507,       510,
             512,       515,       520,       523,       525,       526,
             527,       531,       534,       540,       542,       543,
             544,       549,       551,       556,       558,       559,
             564,       565,       566,       573,       574,       575,
             576,       577,       580,       581,       582,       583,
             587,       588,       590,       591,       593,       596,
             597,       598,       599,       600,       601,       604,
             605,       608,       609,       610,       612,       613,
             614,       616,       620,       621,       622,       625,
             628,       629,       630,       632,       634,       638,
             639,       642,       643,       648,       649,       651,
             653,       654,       655,       656,       657,       661,
             662,       663,       664,       667,       670,       671,
             672,       675,       678,       679,       680,       685,
             687,       689,       692,       693,       694,       696,
             698,       699,       702,       703,       704,       706,
             707,       711,       718,       721,       725,       727,
             729,       732,       733,       735,       741,       743,
             749,       750,       754,       755,       757,       759,
             763,       765,       767,       771,       772,       773,
             774,       778,       780,       781,       783,       786,
             788,       791,       795,       797,       800,       803,
             804,       805,       806,       810,       811,       814,
             816,       819,       820,       821,       827,       828,
             830,       831,       834,       836,       838,       839,
             842,       843,       844,       846,       847,       849,
             851,       852,       854,       857,       859,       862,
             867,       869,       872,       873,       874,       878,
             880,       882,       888,       889,       893,       897,
             898,       902,       903,       905,       906,       907,
             910,       912,       914,       919,       927,       929,
             930,       931,       935,       936,       939,       943,
             944,       945,       946,       950,       951,       952,
             954,       955,       957,       959,       961,       962,
             963,       965,       966,       968,       969,       970,
             973,       974,       975,       976,       977,       978,
             980,       981,       982,       984,       988,       989,
             990,       996,       997,       998,      1004,      1005,
            1006,      1007,      1010,      1015,      1020,      1021,
            1022,      1023,      1025,      1026,      1029,      1030,
            1031,      1033,      1035,      1037,      1038,      1039,
            1041,      1044,      1045,      1046,      1047,      1048,
            1049,      1052,      1054,      1056,      1058,      1061,
            1062,      1064,      1066,      1069,      1070,      1072,
            1074,      1077,      1079,      1081,      1084,      1085,
            1086,      1088,      1089,      1090,      1091,      1093,
            1094,      1096,      1097,      1098,      1101,      1102,
            1104,      1105,      1106,      1107,      1109,      1111,
            1113,      1114,      1120,      1121,      1125,      1126,
            1127,      1128,      1139,     10671,     10703,     10704,
       182305693, 182305697, 182305701, 182305705, 182305709, 182305713,
       312782550, 312782554, 312782558, 312782562, 312782566, 312782570,
       312782578, 312782582, 312782586, 312782590, 312782594, 312782598,
       312782604, 312782608, 312782612, 312782616, 312782620, 312782624,
       312782632, 312782636, 312782640, 312782644, 312782648, 312782652,
       484682470, 484682508, 496345664, 496345668, 496345672, 526157192,
       526157196, 526322264, 527696977, 549009203, 549009211, 549009215,
       549009219, 549009223, 549009227, 560581551, 560581559, 560581563,
       563807435, 563807439, 576073699, 576073704, 589508447, 589508451,
       589508455, 599626923, 599626927, 606826647, 606826651, 606826655,
       606826659, 606826663, 607344830, 607344834, 607344838, 607344842,
       607344846, 607344850, 607344854, 607344858, 607344862, 614454277]


#Regional indices for the reduced R314 regions of CCFv3 atlas. When use this
# regions, one should use the reduced mask (MASK-R314)!
REGION314 = [        1,       345,         7,       361,       294,        12,
              15,        19,       918,        23,        27,        30,
             385,        35,      1057,        38,       533,       795,
              56,        58,        59,        63,        64,        66,
             184,        72,       409,        75,        83,       972,
              88,        91,        96,       541,       100,       101,
             398,       106,       337,       115,       118,       111,
             867,       126,       128,       131,       133,       136,
             135,       146,       147,       149,       491,       155,
            1011,       159,       162, 606826663,       169,       173,
             177,       178,       181,       186,       151,       189,
       607344830,       194,       197,       329,       202,       203,
             206,       207,       209,       210,        39,       214,
             215,       217,       218,       222,       223,       225,
             226,       230,       231,       402,       238,       246,
            1027,       250,      1002,       255,       258,       619,
             262,       263,       266,       425,       271,       272,
             879,       894,       280,       394,       286,       287,
             746,       292,        48,       298,       295,       307,
             310,       318,       985,       321,       325,       319,
             104,       332,       333,       922,       338,       342,
             347,       350,       351,       356,       358,       362,
             364,       366,       372,       374,       381,       382,
             390,       403,       723,       414,       422,       423,
             895,       429,       886,     10671,       437,       445,
             369,       452,       460,       463,       726,       470,
             483,       731,       502,       507,       515,      1018,
             523,       525,       926,       531,       534,       536,
              44,       353,       564,       566,       574,       575,
             576,       170,       580,       581,       583,       591,
             596,       589,       599,       604,       609,       612,
             614,       616,       621,       628,       629,       634,
             639,       642,       651,       653,       647,       993,
             661,       672,       119,       679,       685,       689,
             693,       706,       711,       718,       725,       733,
             741, 484682470,       749,       754,       757,       763,
             765,       773,       780,       781, 484682508,       788,
             797,       378,         4,       814,       830,       302,
             839,       843,       846,       677,       852,       859,
             872,       874,       880,       898,       903,       907,
             912,       914, 182305689,       930,       931,       936,
             944,       946,       951,       952, 560581559,       235,
             957, 560581563,       961,       966,       968,       970,
             975,       920,       978,       980,       982,       989,
             998,      1004,      1007,      1020,      1022,      1025,
            1029,      1031,      1033,      1037,      1039,      1041,
            1044,      1048,      1049,      1052,      1017,      1061,
            1069,       475,      1077,      1084,       928,      1093,
             127,      1098,      1105,      1107,      1109,      1113,
            1120,      1126, 599626923, 599626927, 563807435, 563807439,
       312782546, 312782574,       417, 312782628, 549009211, 549009215,
       549009219, 549009223, 549009227, 589508447, 589508451, 589508455,
       576073699, 576073704]

